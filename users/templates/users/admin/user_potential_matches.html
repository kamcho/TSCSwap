{% extends 'users/base.html' %}
{% load static %}

{% block title %}{{ title }} - TSC Swap{% endblock %}

{% block extra_css %}
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
<style>
    
    .dashboard-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
    }
    
    .dashboard-card {
        background: transparent;
        border: 1px solid rgba(148, 163, 184, 0.2);
        border-radius: 12px;
        padding: 1.5rem;
        transition: all 0.3s ease;
    }
    
    .dashboard-card:hover {
        border-color: rgba(59, 130, 246, 0.4);
        transform: translateY(-2px);
    }
    
    .dashboard-card-header {
        display: flex;
        align-items: center;
        margin-bottom: 1.25rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid rgba(148, 163, 184, 0.15);
    }
    
    .dashboard-card-title {
        font-size: 1rem;
        font-weight: 600;
        color: #ffffff;
        margin: 0;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }
    
    .dashboard-card-content {
        color: #e2e8f0;
    }
    
    .dashboard-info-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.75rem 0;
        border-bottom: 1px solid rgba(148, 163, 184, 0.1);
    }
    
    .dashboard-info-row:last-child {
        border-bottom: none;
    }
    
    .dashboard-label {
        color: #94a3b8;
        font-size: 0.8125rem;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }
    
    .dashboard-value {
        color: #ffffff;
        font-weight: 500;
        font-size: 0.9375rem;
        text-align: right;
    }
    
    
    .info-item {
        margin-bottom: 1rem;
        padding: 0.75rem;
        background: rgba(148, 163, 184, 0.05);
        border-radius: 6px;
        border-left: 3px solid rgba(59, 130, 246, 0.3);
    }
    
    .info-label {
        color: #94a3b8;
        font-size: 0.75rem;
        margin-bottom: 0.5rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }
    
    .info-value {
        color: #ffffff;
        font-weight: 500;
        font-size: 0.9375rem;
    }
    
    /* Matches Section */
    .matches-section {
        margin-top: 2rem;
    }
    
    .matches-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1.5rem;
        margin-top: 1.5rem;
    }
    
    /* Match Cards */
    .match-card {
        background: transparent;
        border-radius: 12px;
        padding: 1.5rem;
        border: 1px solid rgba(148, 163, 184, 0.2);
        transition: all 0.3s ease;
    }
    
    .match-card:hover {
        transform: translateY(-4px);
        border-color: rgba(59, 130, 246, 0.5);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
    }
    
    .match-header {
        display: flex;
        align-items: center;
        margin-bottom: 1rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid rgba(148, 163, 184, 0.15);
    }
    
    .match-avatar {
        width: 56px;
        height: 56px;
        border-radius: 50%;
        background: rgba(59, 130, 246, 0.15);
        border: 2px solid rgba(59, 130, 246, 0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 1rem;
        font-size: 1.5rem;
        color: #60a5fa;
    }
    
    .match-name {
        font-size: 1.125rem;
        font-weight: 700;
        margin: 0 0 0.25rem 0;
        color: #ffffff;
    }
    
    .match-email {
        font-size: 0.8125rem;
        color: #94a3b8;
        margin: 0;
    }
    
    .match-details {
        margin-bottom: 1.5rem;
    }
    .match-details .space-y-3 > * + * {
        margin-top: 0.75rem;
    }
    
    
    .match-subjects {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-bottom: 1.5rem;
    }
    
    .subject-tag {
        background: rgba(148, 163, 184, 0.15);
        color: #cbd5e1;
        padding: 0.375rem 0.875rem;
        border-radius: 9999px;
        font-size: 0.75rem;
        border: 1px solid rgba(148, 163, 184, 0.3);
        font-weight: 500;
    }
    
    .contact-button {
        display: block;
        width: 100%;
        text-align: center;
        background: rgba(59, 130, 246, 0.15);
        color: #60a5fa;
        padding: 0.75rem 1rem;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 600;
        border: 1px solid rgba(59, 130, 246, 0.3);
        transition: all 0.2s ease;
    }
    
    .contact-button:hover {
        background: rgba(59, 130, 246, 0.25);
        border-color: rgba(59, 130, 246, 0.5);
        color: #60a5fa;
        transform: translateY(-1px);
    }
    
    .user-potential-matches {
        padding: 2rem;
        max-width: 1400px;
        margin: 0 auto;
        color: #e2e8f0;
        min-height: 100vh;
    }
    .back-link {
        display: inline-flex;
        align-items: center;
        margin-bottom: 2rem;
        color: #60a5fa;
        text-decoration: none;
        font-weight: 500;
        transition: color 0.2s;
    }
    .back-link:hover {
        color: #3b82f6;
        text-decoration: none;
    }
    .user-card {
        background: transparent;
        border: 1px solid rgba(148, 163, 184, 0.2);
        border-radius: 12px;
        padding: 1.5rem;
        margin-bottom: 2rem;
    }
    .user-card h2 {
        margin-top: 0;
        color: #ffffff;
        font-size: 1.875rem;
        font-weight: 700;
        border-bottom: 1px solid rgba(148, 163, 184, 0.15);
        padding-bottom: 0.75rem;
        margin-bottom: 1.5rem;
    }
    .info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
    }
    .info-section {
        background: transparent;
        border: 1px solid rgba(148, 163, 184, 0.15);
        border-radius: 8px;
        padding: 1.25rem;
    }
    .info-section h3 {
        margin-top: 0;
        color: #94a3b8;
        font-size: 0.875rem;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        border-bottom: 1px solid rgba(148, 163, 184, 0.15);
        padding-bottom: 0.75rem;
        margin-bottom: 1rem;
        font-weight: 600;
    }
    .badge {
        display: inline-block;
        padding: 0.375rem 0.75rem;
        border-radius: 9999px;
        font-size: 0.75rem;
        font-weight: 600;
        margin-right: 0.5rem;
        margin-bottom: 0.5rem;
    }
    .badge-primary {
        background-color: rgba(59, 130, 246, 0.2);
        color: #60a5fa;
        border: 1px solid rgba(59, 130, 246, 0.3);
    }
    .badge-secondary {
        background-color: rgba(148, 163, 184, 0.15);
        color: #cbd5e1;
        border: 1px solid rgba(148, 163, 184, 0.3);
    }
    .matches-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 1.5rem;
        margin-top: 2rem;
    }
    .no-matches {
        text-align: center;
        padding: 4rem 2rem;
        background: transparent;
        border: 1px dashed rgba(148, 163, 184, 0.3);
        border-radius: 12px;
        margin-top: 2rem;
    }
    .no-matches-icon {
        font-size: 3rem;
        color: #64748b;
        margin-bottom: 1rem;
    }
    .no-matches h3 {
        color: #94a3b8;
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
    }
    .no-matches p {
        color: #64748b;
        font-size: 0.875rem;
    }
    .contact-button {
        display: inline-block;
        background: rgba(59, 130, 246, 0.15);
        color: #60a5fa;
        padding: 0.75rem 1.5rem;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 600;
        margin-top: 1rem;
        border: 1px solid rgba(59, 130, 246, 0.3);
        transition: all 0.2s ease;
    }
    .contact-button:hover {
        background: rgba(59, 130, 246, 0.25);
        border-color: rgba(59, 130, 246, 0.5);
        color: #60a5fa;
        text-decoration: none;
        transform: translateY(-1px);
    }
</style>
{% endblock %}

{% block content %}
<div class="user-potential-matches">
    <a href="{% url 'users_admin:user_management' %}" class="back-link">‚Üê Back to User Management</a>
    
    <!-- Dashboard Header -->
    <div class="mb-8">
        <div class="flex items-center justify-between mb-4">
            <div>
                <h1 class="text-4xl font-bold text-white mb-2">{{ user.full_name }}</h1>
                <p class="text-gray-400">Teacher Profile & Potential Matches</p>
            </div>
            <div class="text-right">
                <div class="px-6 py-3 bg-blue-500/20 border border-blue-500/30 rounded-xl">
                    <div class="text-3xl font-bold text-blue-400">{{ potential_matches|length }}</div>
                    <div class="text-xs text-blue-300 uppercase tracking-wide mt-1">Potential Matches</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Dashboard Grid -->
    <div class="dashboard-grid mb-8">
        <!-- Personal Info Card -->
        <div class="dashboard-card">
            <div class="dashboard-card-header">
                <i class="fas fa-user-circle text-blue-400 text-xl mr-3"></i>
                <h3 class="dashboard-card-title">Personal Information</h3>
            </div>
            <div class="dashboard-card-content">
                <div class="dashboard-info-row">
                    <span class="dashboard-label">Email</span>
                    <span class="dashboard-value">{{ user.email }}</span>
                </div>
                <div class="dashboard-info-row">
                    <span class="dashboard-label">Phone</span>
                    <span class="dashboard-value">{{ user.phone }}</span>
                </div>
                <div class="dashboard-info-row">
                    <span class="dashboard-label">TSC Number</span>
                    <span class="dashboard-value">{{ user.tsc_number|default:"Not provided" }}</span>
                </div>
                <div class="dashboard-info-row">
                    <span class="dashboard-label">ID Number</span>
                    <span class="dashboard-value">{{ user.id_number|default:"Not provided" }}</span>
                </div>
            </div>
        </div>

        <!-- Current School Card -->
        <div class="dashboard-card">
            <div class="dashboard-card-header">
                <i class="fas fa-school text-blue-400 text-xl mr-3"></i>
                <h3 class="dashboard-card-title">Current School</h3>
            </div>
            <div class="dashboard-card-content">
                {% if user.school %}
                    <div class="mb-4">
                        <div class="text-lg font-bold text-white mb-1">{{ user.school.name }}</div>
                        <div class="text-sm text-gray-400">{{ user.school.ward }}, {{ user.school.constituency }}</div>
                        <div class="text-xs text-gray-500 mt-1">{{ user.school.county }}</div>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="px-3 py-1.5 bg-purple-500/20 text-purple-300 rounded-full text-sm font-medium border border-purple-500/30">
                            <i class="fas fa-graduation-cap mr-1.5"></i>
                            {{ user.school.level }}
                        </span>
                    </div>
                {% else %}
                    <div class="text-gray-400 italic">No school information available</div>
                {% endif %}
            </div>
        </div>

        <!-- Subjects Card -->
        <div class="dashboard-card">
            <div class="dashboard-card-header">
                <i class="fas fa-book text-blue-400 text-xl mr-3"></i>
                <h3 class="dashboard-card-title">Teaching Subjects</h3>
            </div>
            <div class="dashboard-card-content">
                {% if user.subjects %}
                    <div class="flex flex-wrap gap-2">
                        {% for subject in user.subjects %}
                            <span class="subject-tag">
                                {{ subject }}
                            </span>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="text-gray-400 italic">No subjects listed</div>
                {% endif %}
            </div>
        </div>

        <!-- Swap Preferences Card -->
        <div class="dashboard-card">
            <div class="dashboard-card-header">
                <i class="fas fa-map-marked-alt text-blue-400 text-xl mr-3"></i>
                <h3 class="dashboard-card-title">Swap Preferences</h3>
            </div>
            <div class="dashboard-card-content">
                <div class="space-y-3">
                    <div>
                        <span class="dashboard-label block mb-1">Desired County</span>
                        <span class="px-3 py-1.5 bg-green-500/20 text-green-300 rounded-full text-sm font-medium border border-green-500/30 inline-block">
                            {{ user.preferences.desired_county|default:"Any" }}
                        </span>
                    </div>
                    <div>
                        <span class="dashboard-label block mb-1">Desired Constituency</span>
                        <span class="dashboard-value">{{ user.preferences.desired_constituency|default:"Any" }}</span>
                    </div>
                    <div>
                        <span class="dashboard-label block mb-1">Open To All</span>
                        {% if user.preferences.open_to_all %}
                            <span class="px-3 py-1.5 bg-blue-500/20 text-blue-300 rounded-full text-sm font-medium border border-blue-500/30 inline-block">
                                {{ user.preferences.open_to_all }}
                            </span>
                        {% else %}
                            <span class="text-gray-400 italic text-sm">Not specified</span>
                        {% endif %}
                    </div>
                    <div>
                        <span class="dashboard-label block mb-1">Hardship Preference</span>
                        {% if user.preferences.is_hardship %}
                            <span class="badge badge-primary">
                                <i class="fas fa-exclamation-triangle mr-1"></i>
                                Hardship Area
                            </span>
                        {% else %}
                            <span class="badge badge-secondary">Non-Hardship</span>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Potential Matches Section -->
    <div class="matches-section">
        <div class="flex items-center justify-between mb-6">
            <div>
                <h2 class="text-2xl font-bold text-white mb-2">Potential Swap Matches</h2>
                <p class="text-gray-400 text-sm">Teachers who match this user's preferences and location</p>
            </div>
            <div class="px-4 py-2 bg-blue-500/20 border border-blue-500/30 rounded-lg">
                <div class="text-xl font-bold text-blue-400">{{ potential_matches|length }}</div>
                <div class="text-xs text-blue-300 uppercase tracking-wide">Total Matches</div>
            </div>
        </div>
        
        {% if has_matches %}
            <div class="matches-grid">
                {% for match in potential_matches %}
                    <div class="match-card">
                        <div class="match-header">
                            <div class="match-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="flex-1">
                                <h3 class="match-name">{{ match.full_name }}</h3>
                                <p class="match-email text-sm text-gray-400">{{ match.email }}</p>
                                {% if match.phone and match.phone != '-' %}
                                    <p class="text-xs text-gray-500 mt-1 flex items-center">
                                        <i class="fas fa-phone-alt mr-1.5"></i> 
                                        {{ match.phone }}
                                    </p>
                                {% endif %}
                            </div>
                        </div>
                        
                        <div class="match-details space-y-3">
                            {% if match.school %}
                                <div class="bg-slate-800/30 rounded-lg p-3 border border-slate-700/30">
                                    <div class="flex items-start">
                                        <i class="fas fa-school text-blue-400 mr-2 mt-0.5"></i>
                                        <div class="flex-1">
                                            <p class="match-school font-semibold text-white mb-1">{{ match.school.name }}</p>
                                            <p class="match-location text-xs text-gray-400 flex items-center">
                                                <i class="fas fa-map-marker-alt mr-1.5 text-gray-500"></i>
                                                {{ match.school.ward }}, {{ match.school.county }}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex items-center text-sm">
                                    <span class="px-3 py-1 bg-purple-500/20 text-purple-300 rounded-full text-xs font-medium border border-purple-500/30">
                                        <i class="fas fa-graduation-cap mr-1.5"></i>
                                        {{ match.school.level }}
                                    </span>
                                </div>
                            {% endif %}
                            
                            {% if match.subjects %}
                                <div>
                                    <h4 class="text-xs uppercase tracking-wide text-gray-400 mb-2 flex items-center">
                                        <i class="fas fa-book mr-1.5"></i>
                                        Teaching Subjects
                                    </h4>
                                    <div class="match-subjects">
                                        {% for subject in match.subjects|slice:":4" %}
                                            <span class="subject-tag">{{ subject }}</span>
                                        {% endfor %}
                                        {% if match.subjects|length > 4 %}
                                            <span class="subject-tag">+{{ match.subjects|length|add:"-4" }} more</span>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="mt-4 pt-4 border-t border-slate-700/30">
                            <a href="mailto:{{ match.email }}" class="contact-button">
                                <i class="fas fa-envelope mr-2"></i> 
                                Send Message
                            </a>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="no-matches">
                <div class="no-matches-icon">
                    <i class="fas fa-search"></i>
                </div>
                <h3>No Matches Found</h3>
                <p>This user doesn't have any potential swap matches at the moment.</p>
                <p class="text-xs text-gray-500 mt-2">Matches are based on location preferences and teaching subjects.</p>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}

